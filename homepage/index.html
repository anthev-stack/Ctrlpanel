<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GameControl | Game Hosting Made Easy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle fill='%236366f1' cx='32' cy='32' r='32'/%3E%3Ctext x='32' y='40' font-size='28' text-anchor='middle' fill='%23fff' font-family='Inter, sans-serif'%3EGC%3C/text%3E%3C/svg%3E">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body>
    <header class="hero">
        <nav class="nav">
            <div class="logo">
                <span>Gamecontrol</span>
                <small>Command Centre</small>
            </div>
            <button class="nav-toggle" type="button" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-drawer" id="primary-nav">
                <div class="nav-links">
                    <a href="#features">Features</a>
                    <a href="#servers">Servers</a>
                    <a href="#configure">Configurator</a>
                    <a href="#faq">FAQ</a>
                </div>
                <div class="nav-links nav-links--secondary">
                    <a href="https://panel.gamecontrol.cc" target="_blank" rel="noopener">Panel Login</a>
                    <a href="https://billing.gamecontrol.cc" target="_blank" rel="noopener">Billing Login</a>
                </div>
            </div>
            <button class="btn nav-cta" onclick="window.location.href='https://billing.gamecontrol.cc'">Get Started</button>
        </nav>
        <div class="hero-content">
            <div class="hero-text">
                <h1>Spin Up Game Servers for Your Community in Minutes</h1>
                <p>
                    GameControl gives you a modern billing layer on top of Pterodactyl, ready to sell Counter-Strike 2 and more.
                    Provision in seconds, automate renewals, and let players scale their resources on demand.
                </p>
                <div class="hero-actions">
                    <a class="btn" href="#servers">Browse Servers</a>
                    <a class="btn btn-outline" href="#configure">Configure & Launch</a>
                </div>
                <div class="hero-meta">
                    <span>âœ“ Automated provisioning</span>
                    <span>âœ“ Credits & referrals</span>
                    <span>âœ“ Enhanced Pterodactyl panel</span>
                </div>
            </div>
            <div class="hero-card">
                <h2>Featured Plan: Counter-Strike 2</h2>
                <ul>
                    <li><strong>2.5 GB</strong> DDR4 RAM</li>
                    <li><strong>75 GB</strong> NVMe storage</li>
                    <li><strong>1 vCPU</strong> @ 100% burst</li>
                    <li>Customisable slots & addons</li>
                </ul>
                <button class="btn btn-block" onclick="window.location.href='https://billing.gamecontrol.cc'">Launch in 60 seconds</button>
            </div>
        </div>
    </header>

    <section id="features" class="section">
        <h2>Built for Game Communities</h2>
        <div class="grid grid-3">
            <div class="card">
                <h3>Automated Provisioning</h3>
                <p>Spin up servers instantly on our infrastructure. Templates, addons, and scaling are built in.</p>
            </div>
            <div class="card">
                <h3>Flexible Billing</h3>
                <p>Credits, automated renewals, referrals, and slot-based pricing keep your community covered.</p>
            </div>
            <div class="card">
                <h3>Player-Centric Experience</h3>
                <p>Modern storefront, tickets, and an enhanced Pterodactyl control panel keep players in control.</p>
            </div>
        </div>
    </section>

    <div x-data="configureApp()" x-init="init()">
    <section id="servers" class="section">
            <h2>Servers</h2>
            <p class="section-lead">Pick a default build or configure it your way.</p>
            <div class="grid grid-3" x-show="plans.length">
                <template x-for="plan in plans" :key="plan.slug">
                    <div class="card pricing-card" :class="{'featured': selectedPlan === plan.slug}">
                        <h3 x-text="plan.name"></h3>
                        <p class="price">
                            <span class="credit-price" x-text="formatCredits(plan.price) + ' credits'"></span>
                            <span class="price-sub" x-text="formatAud(plan.price) + ' / ' + plan.billing_period"></span>
                        </p>
                        <ul>
                            <li x-text="planBaseRamLabel(plan) + ' · ' + planBaseSlotsLabel(plan)"></li>
                            <li x-text="plan.description"></li>
                        </ul>
                        <button class="btn btn-block" @click="selectPlanAndScroll(plan.slug)">Configure</button>
                    </div>
                </template>
            </div>
            <div class="card pricing-card" x-show="loading">
                <p>Loading servers…</p>
            </div>
    </section>

    <section id="configure" class="section">
            <h2>Configure & Launch</h2>
            <p class="section-lead">Dial in RAM, slots, and regions—then head to billing to finish checkout.</p>
            <div class="configurator-inline">
                <div class="config-card">
                    <h3>Configuration</h3>
                    <label class="form-label mt-2">Game</label>
                    <div class="select-control mt-1">
                        <select class="custom-select" x-model="selectedPlan" @change="setPlan($event.target.value)">
                            <template x-for="plan in plans" :key="plan.slug">
                                <option :value="plan.slug"
                                        x-text="`${plan.name} · ${formatCredits(plan.price)} credits`"></option>
                            </template>
                        </select>
                        <span class="select-caret">⌄</span>
                    </div>
                    <label class="form-label mt-3">Location</label>
                    <div class="select-control mt-1">
                        <select class="custom-select" x-model="selectedLocation" @change="ensureLocation()">
                            <template x-for="location in locationOptions" :key="location.id">
                                <option :value="location.id"
                                        x-text="formatLocationOption(location)"></option>
                            </template>
                        </select>
                        <span class="select-caret">⌄</span>
                    </div>
                    <p class="config-note" x-show="currentPlan">
                        <strong x-text="currentPlan.name"></strong>
                        <span class="text-muted d-block" x-text="currentPlan.description"></span>
                    </p>
                </div>

                <div class="config-card stretch">
                    <h3>Resources</h3>

                    <div class="range-group" x-show="hasMemoryIncrements()">
                        <div class="range-label">
                            <span>RAM</span>
                            <span x-text="ramLabel()"></span>
                        </div>
                        <div class="range-wrapper">
                            <input type="range" min="0" :max="ramMaxSteps()" step="1" class="config-range"
                                x-model.number="ramSteps" @input="updatePrice" :disabled="!hasMemoryIncrements()">
                        </div>
                        <small class="text-muted" x-text="ramDescription()"></small>
                    </div>

                    <div class="range-group" x-show="hasSlotIncrements()">
                        <div class="range-label">
                            <span>Player Slots</span>
                            <span x-text="slotLabel()"></span>
                        </div>
                    <div class="range-wrapper">
                        <input type="range" min="0" :max="slotMaxSteps()" step="1" class="config-range"
                            x-model.number="slotSteps" @input="updatePrice" :disabled="!hasSlotIncrements()">
                    </div>
                        <small class="text-muted" x-text="slotDescription()"></small>
                    </div>

                    <div class="alert alert-info" x-show="loading">
                        Loading configuration options…
                    </div>
                    <div class="alert alert-info" x-show="!currentPlan && !loading">
                        Select a game on the left to unlock resource controls.
                    </div>
                </div>

                <div class="config-card summary-box">
                    <h3>Summary</h3>
                    <div class="summary-line">
                        <span>Game</span>
                        <strong x-text="currentPlan ? currentPlan.name : '—'"></strong>
                    </div>
                    <div class="summary-line">
                        <span>Location</span>
                        <strong x-text="locationLabel()"></strong>
                    </div>
                    <div class="summary-line">
                        <span>Memory</span>
                        <strong x-text="ramLabel()"></strong>
                    </div>
                <div class="summary-line">
                    <span>Player Slots</span>
                    <strong x-text="slotLabel()"></strong>
                </div>
                <div class="summary-total">
                        <span>Total</span>
                    <div class="text-right">
                        <strong x-text="formatCredits(totalPrice) + ' credits / ' + billingPeriodLabel()"></strong>
                        <small class="text-muted d-block" x-text="summaryAudLabel()"></small>
                    </div>
                    </div>
                    <p class="mt-2 text-muted" style="font-size: 0.9rem;">
                        Final provisioning and billing happens inside our secure client area.
                    </p>
                    <button class="btn btn-block btn" type="button" @click="continueToBilling">
                        Continue to Billing
                    </button>
                </div>
            </div>
        </section>
    </div>

    <section id="faq" class="section">
        <h2>Frequently Asked Questions</h2>
        <div class="faq">
            <div class="faq-item">
                <h3>Does GameControl replace Pterodactyl?</h3>
                <p>Noâ€”GameControl sits alongside Pterodactyl and handles storefront, billing, and customer automation.</p>
            </div>
            <div class="faq-item">
                <h3>Can I customise resource sliders and pricing?</h3>
                <p>Absolutely. Build dynamic addons such as slot-based pricing, RAM upgrades, or region selectors with a few clicks.</p>
            </div>
            <div class="faq-item">
                <h3>What payment methods are supported?</h3>
                <p>Stripe, PayPal, and custom gateways. Credits and vouchers let you run promotions easily.</p>
            </div>
        </div>
    </section>
    </div>

    <footer class="footer">
        <div class="footer-grid">
            <div>
                <h4>GameControl</h4>
                <p>Modern billing & automation for game hosting providers.</p>
            </div>
            <div>
                <h4>Product</h4>
                <ul>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#pricing">Pricing</a></li>
                    <li><a href="https://panel.gamecontrol.cc" target="_blank" rel="noopener">Control Panel</a></li>
                </ul>
            </div>
            <div>
                <h4>Company</h4>
                <ul>
                    <li><a href="mailto:support@gamecontrol.cc">Support</a></li>
                    <li><a href="mailto:sales@gamecontrol.cc">Sales</a></li>
                    <li><a href="https://billing.gamecontrol.cc" target="_blank" rel="noopener">Client Area</a></li>
                </ul>
            </div>
        </div>
        <p class="footer-meta">Â© <span id="year"></span> GameControl. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navToggle = document.querySelector('.nav-toggle');
            const navDrawer = document.querySelector('.nav-drawer');
            if (navToggle && navDrawer) {
                navToggle.addEventListener('click', () => {
                    navDrawer.classList.toggle('open');
                    navToggle.classList.toggle('open');
                });

                navDrawer.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                        navDrawer.classList.remove('open');
                        navToggle.classList.remove('open');
                    });
                });
            }
        });
    </script>

    <script>
        const BILLING_BASE_URL = window.__GC_BILLING_BASE || 'https://billing.gamecontrol.cc';

        document.addEventListener('alpine:init', () => {
            Alpine.data('configureApp', () => ({
                plans: [],
                locations: [],
                loading: true,
                selectedPlan: null,
                selectedLocation: null,
                ramSteps: 0,
                slotSteps: 0,
                totalPrice: 0,

                init() {
                    this.fetchPlans();
                },

                async fetchPlans() {
                    try {
                        const response = await fetch(`${BILLING_BASE_URL}/api/public/plans`);
                        if (!response.ok) {
                            throw new Error('Unable to load plans');
                        }
                        const data = await response.json();
                        this.plans = data;
                        this.locations = this.collectLocations(data);
                        if (!this.selectedPlan && data.length) {
                            this.selectedPlan = data[0].slug;
                        }
                        this.ensureLocation();
                        this.updatePrice();
                    } catch (error) {
                        console.error(error);
                        this.plans = [];
                        this.locations = [];
                    } finally {
                        this.loading = false;
                    }
                },

                get currentPlan() {
                    return this.plans.find(plan => plan.slug === this.selectedPlan) || null;
                },

                get locationOptions() {
                    const plan = this.currentPlan;
                    if (plan && plan.locations && plan.locations.length) {
                        return plan.locations;
                    }
                    return this.locations;
                },

                setPlan(slug) {
                    if (!this.plans.find(plan => plan.slug === slug)) {
                        return;
                    }
                    this.selectedPlan = slug;
                    this.ramSteps = 0;
                    this.slotSteps = 0;
                    this.ensureLocation();
                    this.updatePrice();
                },

                selectPlanAndScroll(slug) {
                    this.setPlan(slug);
                    const section = document.getElementById('configure');
                    if (section) {
                        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                },

                updatePrice() {
                    const plan = this.currentPlan;
                    if (!plan) return;
                    const ramCost = this.ramSteps * (plan.memory_increment_price || 0);
                    const slotCost = this.slotSteps * (plan.slot_increment_price || 0);
                    this.totalPrice = plan.price + ramCost + slotCost;
                },

                hasMemoryIncrements() {
                    const plan = this.currentPlan;
                    return plan && plan.memory_increment_mb > 0 && plan.memory_increment_max_steps > 0;
                },

                hasSlotIncrements() {
                    const plan = this.currentPlan;
                    return plan && plan.slot_increment_step > 0 && plan.slot_increment_max_steps > 0;
                },

                ramMaxSteps() {
                    const plan = this.currentPlan;
                    return plan ? plan.memory_increment_max_steps : 0;
                },

                slotMaxSteps() {
                    const plan = this.currentPlan;
                    return plan ? plan.slot_increment_max_steps : 0;
                },

                ramLabel() {
                    const plan = this.currentPlan;
                    if (!plan) return '—';
                    const value = plan.memory_mb + (this.ramSteps * plan.memory_increment_mb);
                    return this.formatMemory(value);
                },

                ramDescription() {
                    const plan = this.currentPlan;
                    if (!plan || this.ramSteps === 0) return 'Using base memory allocation.';
                    const extra = this.ramSteps * plan.memory_increment_mb;
                    const cost = this.ramSteps * (plan.memory_increment_price || 0);
                    return `+${this.formatMemory(extra)} · +${this.formatCredits(cost)} credits · ≈ ${this.formatAud(cost)}`;
                },

                slotLabel() {
                    const plan = this.currentPlan;
                    if (!plan) return '—';
                    const value = plan.player_slots + (this.slotSteps * plan.slot_increment_step);
                    return `${value} slots`;
                },

                slotDescription() {
                    const plan = this.currentPlan;
                    if (!plan || this.slotSteps === 0) return 'Using base player slots.';
                    const extra = this.slotSteps * plan.slot_increment_step;
                    const cost = this.slotSteps * (plan.slot_increment_price || 0);
                    return `+${extra} slots · +${this.formatCredits(cost)} credits · ≈ ${this.formatAud(cost)}`;
                },

                locationLabel() {
                    const location = this.findLocation(this.selectedLocation);
                    return location ? this.formatLocationOption(location) : '—';
                },

                planBaseRamLabel(plan) {
                    return this.formatMemory(plan.memory_mb);
                },

                planBaseSlotsLabel(plan) {
                    return `${plan.player_slots ?? 0} slots`;
                },

                continueToBilling() {
                    const plan = this.currentPlan;
                    if (!plan) return;
                    const url = new URL(`${BILLING_BASE_URL}/register`);
                    url.searchParams.set('plan', plan.slug);
                    url.searchParams.set('ram_steps', this.ramSteps);
                    url.searchParams.set('slot_steps', this.slotSteps);
                    if (this.selectedLocation) {
                        url.searchParams.set('location', this.selectedLocation);
                    }
                    window.location.href = url.toString();
                },

                formatMemory(mb) {
                    if (!mb) return '0 MB';
                    if (mb >= 1024) {
                        return `${(mb / 1024).toFixed(1)} GB`;
                    }
                    return `${mb} MB`;
                },

                formatCredits(value) {
                    return Number(value || 0).toLocaleString(undefined, {
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    });
                },

                creditsToAudNumber(value) {
                    return Number(value || 0) / 100;
                },

                formatAud(value) {
                    return '$' + this.creditsToAudNumber(value).toLocaleString(undefined, {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    }) + ' AUD';
                },

                summaryAudLabel() {
                    return '≈ ' + this.formatAud(this.totalPrice) + ' / ' + this.billingPeriodLabel();
                },

                billingPeriodLabel() {
                    return this.currentPlan ? this.currentPlan.billing_period : 'month';
                },

                collectLocations(plans) {
                    const unique = new Map();
                    plans.forEach(plan => {
                        (plan.locations || []).forEach(location => {
                            const key = String(location.id);
                            if (!unique.has(key)) {
                                unique.set(key, {
                                    id: key,
                                    name: location.name || `Node ${key}`,
                                    description: location.description || ''
                                });
                            }
                        });
                    });
                    return Array.from(unique.values());
                },

                ensureLocation() {
                    const options = this.locationOptions;
                    if (!options.length) {
                        this.selectedLocation = null;
                        return;
                    }
                    if (!options.find(loc => String(loc.id) === String(this.selectedLocation))) {
                        this.selectedLocation = options[0].id;
                    }
                },

                formatLocationOption(location) {
                    if (!location) {
                        return '';
                    }
                    if (location.description) {
                        return `${location.name} · ${location.description}`;
                    }
                    return location.name;
                },

                findLocation(id) {
                    if (!id) {
                        return null;
                    }
                    const plan = this.currentPlan;
                    if (plan && plan.locations) {
                        const match = plan.locations.find(loc => String(loc.id) === String(id));
                        if (match) {
                            return match;
                        }
                    }
                    return this.locations.find(loc => String(loc.id) === String(id)) || null;
                }
            }));
        });

        document.getElementById('year').textContent = new Date().getFullYear();
    </script>
</body>
</html>
